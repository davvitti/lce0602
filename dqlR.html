<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCE0602</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/atividade.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>

</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo"> <a href="sobre.html"><span>Estatística experimental</span></a></div>
            <nav class="menu">
                <div class="head">
                    <div class="logo"> </div>
                    <button type="button" class="close-menu-btn"></button>
                </div>
                <ul>
                    <li><a href="index.html"><span>Sobre este site</span></a></li>
                    <li><a href="revisao.html"><span>Revisão</span></a></li>
                    <li class="dropdown">
                        <a href="#"><span>Capítulos</span></a>
                        <i class="fa-solid fa-chevron-down"></i>
                        <ul class="sub-menu">
                            <li><a href="intro.html"><span>Introdução</span></a></li>
                            <li><a href="dic.html"><span>Delineamento inteiramente casualizado</span></a></li>
                            <li><a href="cm.html"><span>Comparação de médias</span></a></li>
                            <li><a href="regpoli.html"><span>Regressão polinomial</span></a></li>
                            <li><a href="atividade.html"><span>Pressuposições da Anova</span></a></li>
                            <li><a href="dbc.html"><span>Delineamento em blocos casualizdos</span></a></li>
                            <li><a href="dql.html"><span>Delineamento quadrado latino</span></a></li>
                            <li><a href="fat.html"><span>Esquema fatorial de tratamentos</span></a></li>
                            <li><a href="parcesub.html"><span>Parcelas subdivididas</span></a></li>
                            <li><a href="gupos.html"><span>Grupos de experimentos</span></a></li>
                            <li><a href="ref.html"><span>Referências</span></a></li>

                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#"><span>Vamos praticar?</span></a>
                        <i class="fa-solid fa-chevron-down"></i>
                        <ul class="sub-menu">
                            <li><a href="estgeralR.html"><span>Revisão: estatística geral</span></a></li>
                            <li><a href="dicR.html"><span>Delineamento inteiramente casualizado</span></a></li>
                            <li><a href="cmR.html"><span>Comparação de médias</span></a></li>
                            <li><a href="regpoliR.html"><span>Regressão polinomial</span></a></li>
                            <li><a href="pressanovaR.html"><span>Pressuposições da Anova</span></a></li>
                            <li><a href="dbcR.html"><span>Delineamento em blocos casualizdos</span></a></li>
                            <li><a href="dqlR.html"><span>Delineamento quadrado latino</span></a></li>
                            <li><a href="fatR.html"><span>Esquema fatorial de tratamentos</span></a></li>
                            <li><a href="parsubR.html"><span>Parcelas subdivididas</span></a></li>
                            <li><a href="gruposR.html"><span>Grupos de experimentos</span></a></li>
                            <li><a href="dicpt.html"><span>Exercícios</span></a></li>

                        </ul>
                    </li>
                   
                     
                    <li><a href="contato.html"><span>Dúvidas?</span></a></li>
                </ul>

            </nav>
            <div class="header-right">
                
                <button type="button" class="open-menu-btn">
                    <span class="line line-1"></span>
                    <span class="line line-2"></span>
                    <span class="line line-3"></span>
                
                </button>
            </div>
            
        </div>

    </header>
    <section class="hero">
        <section class="atras">
            <div class="fundo">
                <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; # Planejamento
                    #&#39; 
                    #&#39; A seguir são apresentados códigos para a realização do planejamento de um experimento Quadrado Latino 5$\times$ 5.
                    #&#39;
                    library(agricolae)
                    (Variedades &lt;- LETTERS[1:5])</span></div></pre>
                    <div class="out"><div><span class="r-output">## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">(Planejamento &lt;- design.lsd(Variedades,
                                                serie=2))</span></div></pre>
                    <div class="out"><div><span class="r-output">## $parameters
                    ## $parameters$design
                    ## [1] &quot;lsd&quot;
                    ## 
                    ## $parameters$trt
                    ## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; &quot;E&quot;
                    ## 
                    ## $parameters$r
                    ## [1] 5
                    ## 
                    ## $parameters$serie
                    ## [1] 2
                    ## 
                    ## $parameters$seed
                    ## [1] -287131376
                    ## 
                    ## $parameters$kinds
                    ## [1] &quot;Super-Duper&quot;
                    ## 
                    ## $parameters[[7]]
                    ## [1] TRUE
                    ## 
                    ## 
                    ## $sketch
                    ##      [,1] [,2] [,3] [,4] [,5]
                    ## [1,] &quot;E&quot;  &quot;C&quot;  &quot;B&quot;  &quot;A&quot;  &quot;D&quot; 
                    ## [2,] &quot;B&quot;  &quot;E&quot;  &quot;D&quot;  &quot;C&quot;  &quot;A&quot; 
                    ## [3,] &quot;D&quot;  &quot;B&quot;  &quot;A&quot;  &quot;E&quot;  &quot;C&quot; 
                    ## [4,] &quot;C&quot;  &quot;A&quot;  &quot;E&quot;  &quot;D&quot;  &quot;B&quot; 
                    ## [5,] &quot;A&quot;  &quot;D&quot;  &quot;C&quot;  &quot;B&quot;  &quot;E&quot; 
                    ## 
                    ## $book
                    ##    plots row col Variedades
                    ## 1    101   1   1          E
                    ## 2    102   1   2          C
                    ## 3    103   1   3          B
                    ## 4    104   1   4          A
                    ## 5    105   1   5          D
                    ## 6    201   2   1          B
                    ## 7    202   2   2          E
                    ## 8    203   2   3          D
                    ## 9    204   2   4          C
                    ## 10   205   2   5          A
                    ## 11   301   3   1          D
                    ## 12   302   3   2          B
                    ## 13   303   3   3          A
                    ## 14   304   3   4          E
                    ## 15   305   3   5          C
                    ## 16   401   4   1          C
                    ## 17   402   4   2          A
                    ## 18   403   4   3          E
                    ## 19   404   4   4          D
                    ## 20   405   4   5          B
                    ## 21   501   5   1          A
                    ## 22   502   5   2          D
                    ## 23   503   5   3          C
                    ## 24   504   5   4          B
                    ## 25   505   5   5          E</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">Plano &lt;- Planejamento$book
                    
                    library(agricolaeplotr)</span></div></pre>
                    <div class="out"><div><span class="r-output">## 
                    ## Type &#39;citation(&quot;agricolaeplotr&quot;)&#39; for citing this R package in publications.</span></div></div>
                    <div class="out"><div><span class="r-output">## 
                    ## Attaching package: &#39;agricolaeplotr&#39;</span></div></div>
                    <div class="out"><div><span class="r-output">## The following object is masked from &#39;package:base&#39;:
                    ## 
                    ##     summary</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">plot_latin_square(Planejamento,
                                      factor_name = &quot;Variedades&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input"># library(ggplot2)
                    # ggplot(Plano, aes(x = col, y = row, label = Variedades)) +
                    #   geom_tile(aes(fill = Variedades), color=&quot;black&quot;) +
                    #   geom_text() +
                    #   xlab(&quot;Colunas&quot;) +
                    #   ylab(&quot;Linhas&quot;)
                    
                    
                    #&#39; Ainda, a partir de um Quadrado Latino sistemático, pode-se sortear as linhas
                    sample(1:5) </span></div></pre>
                    <div class="out"><div><span class="r-output">## [1] 3 4 2 1 5</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; e as Colunas
                    sample(1:5) </span></div></pre>
                    <div class="out"><div><span class="r-output">## [1] 5 2 3 1 4</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; # Análise dos dados
                    #&#39; Considere os dados de um experimento instalado de acordo com o
                    #&#39; delineamento quadrado latino, para avaliar a produção de cana-de-açúcar
                    #&#39; em kg/parcela, de cinco variedades.
                    #&#39; 
                    #&#39; ## Importando os dados
                    (dados &lt;- read.csv2(&quot;cana1.csv&quot;))</span></div></pre>
                    <div class="out"> <div><span class="r-output">##    linha coluna trat prod
                    ## 1      1      2    A  518
                    ## 2      2      3    A  524
                    ## 3      3      5    A  420
                    ## 4      4      4    A  486
                    ## 5      5      1    A  515
                    ## 6      1      3    B  458
                    ## 7      2      4    B  550
                    ## 8      3      2    B  384
                    ## 9      4      1    B  494
                    ## 10     5      5    B  318
                    ## 11     1      4    C  583
                    ## 12     2      1    C  724
                    ## 13     3      3    C  556
                    ## 14     4      5    C  501
                    ## 15     5      2    C  660
                    ## 16     1      1    D  432
                    ## 17     2      5    D  400
                    ## 18     3      4    D  297
                    ## 19     4      2    D  500
                    ## 20     5      3    D  438
                    ## 21     1      5    E  331
                    ## 22     2      2    E  478
                    ## 23     3      1    E  489
                    ## 24     4      3    E  313
                    ## 25     5      4    E  394</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">str(dados)</span></div></pre>
                    <div class="out"><div><span class="r-output">## &#39;data.frame&#39;:    25 obs. of  4 variables:
                    ##  $ linha : int  1 2 3 4 5 1 2 3 4 5 ...
                    ##  $ coluna: int  2 3 5 4 1 3 4 2 1 5 ...
                    ##  $ trat  : chr  &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...
                    ##  $ prod  : int  518 524 420 486 515 458 550 384 494 318 ...</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">dados &lt;- transform(dados,
                                       linha = factor(linha),
                                       coluna = factor(coluna))
                    
                    
                    #&#39; ## Descritiva
                    #&#39;
                    library(ggplot2)</span></div></pre>
                    <div class="out"><div><span class="r-output">## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">ggplot(dados, aes(x = coluna, 
                                      y = linha, 
                                      label = trat)) +
                      geom_tile(aes(fill = prod), 
                                color=&quot;black&quot;) +
                      scale_fill_gradient(low=&quot;white&quot;,
                                          high=&quot;red&quot;) +
                      geom_text() +
                      xlab(&quot;Colunas&quot;) +
                      ylab(&quot;Linhas&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
                    <pre class="code-block"> <div><span class="r-prompt">&gt; </span><span class="r-input">ggplot(dados, 
                           aes(x = trat, 
                               y = prod)) +
                      geom_point()</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-3.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; ## Ajuste do modelo
                    #&#39; 
                    modelo &lt;- aov(prod ~ linha + coluna + trat,
                                  dados) 
                    
                    #&#39; ## Verificando as pressuposições 
                    
                    #&#39; Resíduos Studentizados 
                    (res_stud &lt;- rstandard(modelo))</span></div></pre>
                    <div class="out"><div><span class="r-output">##           1           2           3           4           5           6 
                    ## -0.16134123 -0.55657310  1.22467738  0.36924402 -0.87600707  0.97562716 
                    ##           7           8           9          10          11          12 
                    ##  1.43582865 -1.43366299  0.12560794 -1.10340075 -0.19382604 -0.15592709 
                    ##          13          14          15          16          17          18 
                    ##  0.14185034 -0.42121972  0.62912251 -0.96263323 -0.04223025 -1.80182419 
                    ##          19          20          21          22          23          24 
                    ##  1.64697992  1.15970775  0.34217334 -0.68109820  1.86895946 -1.72061216 
                    ##          25 
                    ##  0.19057756</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">ggplot(NULL, 
                           aes(x=res_stud)) +
                      geom_boxplot() +
                      labs(y = &quot;Resíduos Studentizados&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-4.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; - Normalidade
                    #&#39;
                    # qqnorm(res_stud,
                    #        xlab=&quot;Quantis da distribuição normal&quot;, 
                    #        ylab=&quot;Resíduos Studentizados&quot;); 
                    # qqline(res_stud, col=2)
                    library(hnp)</span></div></pre>
                    <div class="out"><div><span class="r-output">## Carregando pacotes exigidos: MASS</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">hnp(modelo,
                        print.on = TRUE)</span></div></pre>
                    <div class="out"><div><span class="r-output">## Gaussian model (aov object)</span></div></div>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-5.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; $H_0$: Os erros seguem uma distribuição normal *versus* 
                    #&#39; $H_1:$ Os erros não seguem uma distribuição normal.
                    shapiro.test(res_stud)</span></div></pre>
                    <div class="out"><div><span class="r-output">## 
                    ##  Shapiro-Wilk normality test
                    ## 
                    ## data:  res_stud
                    ## W = 0.97701, p-value = 0.8202</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; Ao nível de 5\% de significância não há evidências para afirmarmos que os erros não seguem a distribuição normal.
                    
                    #&#39; - Homogeneidade de variâncias 
                    ggplot(dados, 
                           aes(x = trat, 
                               y = res_stud)) +
                      geom_point() +
                      xlab(&quot;Tratamentos&quot;) +
                      ylab(&quot;Resíduos Studentizados&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-6.png" width="672" /></p>
                    <pre class="code-block"> <div><span class="r-prompt">&gt; </span><span class="r-input">ggplot(dados, 
                           aes(x = coluna, 
                               y = res_stud)) +
                      geom_point() +
                      xlab(&quot;Colunas&quot;) +
                      ylab(&quot;Resíduos Studentizados&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-7.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">ggplot(dados, 
                           aes(x = linha, 
                               y = res_stud)) +
                      geom_point() +
                      xlab(&quot;Linhas&quot;) +
                      ylab(&quot;Resíduos Studentizados&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-8.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; $H_0$: Há homogeneidade de variâncias *versus* 
                    #&#39; $H_1:$ Não há homogeneidade de variâncias.
                    
                    library(lmtest)</span></div></pre>
                    <div class="out"><div><span class="r-output">## Carregando pacotes exigidos: zoo</span></div></div>
                    <div class="out"><div><span class="r-output">## 
                    ## Attaching package: &#39;zoo&#39;</span></div></div>
                    <div class="out"><div><span class="r-output">## The following objects are masked from &#39;package:base&#39;:
                    ## 
                    ##     as.Date, as.Date.numeric</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">bptest(modelo)</span></div></pre>
                    <div class="out"><div><span class="r-output">## 
                    ##  studentized Breusch-Pagan test
                    ## 
                    ## data:  modelo
                    ## BP = 14.538, df = 12, p-value = 0.2677</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; Ao nível de 5\% de significância não há evidências para afirmarmos que não há homogeneidade de variâncias.
                    
                    #&#39; - Relação entre média e variância
                    
                    ggplot(NULL, 
                           aes(x = fitted(modelo), 
                               y = res_stud)) +
                      geom_point() +
                      xlab(&quot;Valores preditos&quot;)  +
                      ylab(&quot;Resíduos Studentizados&quot;) +
                      geom_hline(yintercept = 0, 
                                 col = &quot;red&quot;)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-9.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">library(MASS)
                    boxcox(modelo)</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-10.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">boxcox(modelo,
                           lambda = seq(0, 3, 0.01))</span></div></pre>
                    <p><img src="figs/aula7_files/figure-html/unnamed-chunk-1-11.png" width="672" /></p>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; Como $\lambda = 1$ pertence ao intervalo de confiança e as 
                    #&#39; pressuposições de normalidade dos erros e homogeneidade de 
                    #&#39; variâncias foram atendidas, não há necessidade de 
                    #&#39; transformação dos dados.
                    
                    #&#39; ## ANOVA
                    #&#39; $H_0$: $\mu_1 = \mu_2 = \mu_3 = \mu_4 = \mu_5$ *versus* 
                    #&#39; $H_1:$ Pelo menos duas médias de tratamentos diferem entre si.
                    anova(modelo) </span></div></pre>
                    <div class="out"><div><span class="r-output">## Analysis of Variance Table
                    ## 
                    ## Response: prod
                    ##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
                    ## linha      4  30481    7620  2.6804 0.0831343 .  
                    ## coluna     4  55641   13910  4.8930 0.0142293 *  
                    ## trat       4 137488   34372 12.0905 0.0003585 ***
                    ## Residuals 12  34115    2843                      
                    ## ---
                    ## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></div></div>
                    <pre class="code-block"> <div><span class="r-prompt">&gt; </span><span class="r-input">#&#39; Assumindo-se o nível de 5\% de significância, há evidências para rejeitarmos $H_0$...
                    
                    #&#39; ## ANOVA e comparações múltiplas pela biblioteca ExpDes.pt
                    
                    library(ExpDes.pt) </span></div></pre>
                    <div class="out"><div><span class="r-output">## 
                    ## Attaching package: &#39;ExpDes.pt&#39;</span></div></div>
                    <div class="out"><div><span class="r-output">## The following object is masked from &#39;package:MASS&#39;:
                    ## 
                    ##     ginv</span></div></div>
                    <div class="out"><div><span class="r-output">## The following objects are masked from &#39;package:agricolae&#39;:
                    ## 
                    ##     lastC, order.group, tapply.stat</span></div></div>
                    <pre class="code-block"><div><span class="r-prompt">&gt; </span><span class="r-input">with(dados, 
                         dql(trat, 
                             linha, 
                             coluna, 
                             prod, 
                             quali = TRUE, 
                             mcomp = &quot;tukey&quot;, 
                             sigT = 0.05, 
                             sigF = 0.05))</span></div></pre>
                    <div class="out"><div><span class="r-output">## ------------------------------------------------------------------------
                    ## Quadro da analise de variancia
                    ## ------------------------------------------------------------------------
                    ##            GL     SQ    QM      Fc    Pr&gt;Fc
                    ## Tratamento  4 137488 34372 12.0905 0.000358
                    ## Linha       4  30481  7620  2.6804 0.083134
                    ## Coluna      4  55641 13910  4.8930 0.014229
                    ## Residuo    12  34115  2843                 
                    ## Total      24 257724                       
                    ## ------------------------------------------------------------------------
                    ## CV = 11.33 %
                    ## 
                    ## ------------------------------------------------------------------------
                    ## Teste de normalidade dos residuos (Shapiro-Wilk)
                    ## valor-p:  0.8201574 
                    ## De acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.
                    ## ------------------------------------------------------------------------
                    ## 
                    ## Teste de Tukey
                    ## ------------------------------------------------------------------------
                    ## Grupos Tratamentos Medias
                    ## a     C   604.8 
                    ##  b    A   492.6 
                    ##  b    B   440.8 
                    ##  b    D   413.4 
                    ##  b    E   401 
                    ## ------------------------------------------------------------------------</span></div></div>
                    
                    

            </div>
        </section>
    </section>      
    <script src="java/atividade.js"></script>
    <script src="java/navbar.js"></script>
</body>
</html>   